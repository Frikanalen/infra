---
# defaults for argocd_django role

# Django app settings
argocd_django_app_name: django-api
argocd_django_namespace: "{{ argocd_default_app_namespace }}"
argocd_django_repo_url: https://github.com/Frikanalen/django-api.git
argocd_django_repo_path: chart

# Version - controls both repo revision and image tag
argocd_django_version: "{{ app_versions.django | default('staging') }}"

# Database settings (for secret generation)
argocd_django_db_user: "{{ django_db_user }}"
argocd_django_db_secret_name: "{{ django_db_secret_name }}"
argocd_django_db_host: "{{ django_db_host }}"
argocd_django_db_port: "{{ django_db_port }}"
argocd_django_db_name: "{{ django_db_name }}"

# Helm values - only overrides from chart defaults
argocd_django_values:
  image:
    tag: "{{ argocd_django_version }}"
    
  env:
    ALLOWED_HOSTS: "{{ frikanalen_domain }},localhost,django.default.svc.cluster.local"
    CSRF_TRUSTED_ORIGINS: "{{ frikanalen_base_url }}"

  ingress:
    className: "{{ default_ingress_class }}"
    hosts:
      - host: "{{ frikanalen_domain }}"
        paths:
          - path: /admin
            serviceName: django-api
            servicePort: 8080
          - path: /api
            serviceName: django-api
            servicePort: 8080
          - path: /static
            serviceName: django-api
            servicePort: 80
